<odoo>
    <data>

        <!--<record id="crm_case_form_view_oppor_inherited" model="ir.ui.view">-->
            <!--<field name="name">crm.lead.oppor.inherited.crm</field>-->
            <!--<field name="model">crm.lead</field>-->
            <!--<field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>-->
            <!--<field name="arch" type="xml">-->
                <!--<field name="partner_id" position="attributes">-->
                        <!--<attribute name="required">1</attribute>-->
                        <!--<attribute name="options">{'no_create': True, 'no_edit': True, 'no_create_edit': True}</attribute>-->
                    <!--</field>-->
            <!--</field>-->
        <!--</record>-->

        <record id="inherit_crm_lead_form" model="ir.ui.view">
            <field name="name">crm.lead.form</field>
            <field name="model">crm.lead</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//form/header/button[2]" position="before">

                    <button name="request_sample" attrs="{'invisible': [('sample', '!=', True)]}"
                            string="New Sample Request" type="object" class="oe_highlight"/>

                    <button name="gift" attrs="{'invisible': [('gift_type', '!=', True)]}"
                            type="object" string="New Gift Request" class="oe_highlight"/>


                </xpath>
                <xpath expr="//page[@name='lead']">
                    <field name="quotation" invisible="1"/>
                    <field name="sample" invisible="1"/>
                    <field name="gift_type" invisible="1"/>
                </xpath>
                    <button name="%(sale_crm.sale_action_quotations_new)d" position="replace">
                    <button string="New Quotation" name="%(sale_crm.sale_action_quotations_new)d"
                             type="action" class="oe_highlight" attrs="{'invisible': [('quotation', '!=', True)]}"
                            context="{'search_default_partner_id': partner_id,
                                      'default_partner_id': partner_id,
                                      'default_team_id': team_id,
                                      'default_campaign_id': campaign_id,
                                      'default_medium_id': medium_id,
                                      'default_source_id': source_id,
                                      'default_sale_type': 'sale',
                                      'default_user_id': user_id}"/>
                    </button>
                    <button name="%(sale_crm.sale_action_quotations)d" position="replace">
                        <button class="oe_stat_button" type="action" attrs="{'invisible': [('sale_number', '=', 0)]}"
                                name="%(sale_crm.sale_action_quotations)d" icon="fa-pencil-square-o"
                                context="{'default_partner_id': partner_id, 'default_sale_type': 'sale'}">
                            <div class="o_stat_info">
                                <field name="sale_number" class="o_stat_value"/>
                                <span class="o_stat_text"> Quotation(s) </span>
                            </div>
                        </button>
                    </button>
                    <field name="date_deadline" position="after">
                        <field name="create_date"/>
                    </field>
                    <field name="tag_ids" position="after">
                        <field name="division_ids" widget="many2many_tags" force_save="1" readonly="1"/>
                        <field name="brand_ids" widget="many2many_tags" force_save="1" readonly="1"/>
                        <field name="segment_id" force_save="1" readonly="1"/>
                        <!--<field name="salesperson_name" force_save="1" readonly="1"/>-->
                    </field>
                    <field name="partner_id" position="attributes">
                        <attribute name="required">1</attribute>
                        <attribute name="options">{'no_create': True, 'no_edit': True, 'no_create_edit': True}</attribute>
                    </field>

                    <field name="date_deadline" position="attributes">
                        <attribute name="required">1</attribute>
                    </field>
                    <field name="planned_revenue" position="attributes">
                        <attribute name="attrs">{'required': [('planned_revenue', '=', 0.0)]}</attribute>
                    </field>
                    <field name="user_id" position="attributes">
                        <attribute name="options">{'no_create': True}</attribute>
                    </field>
                    <field name="team_id" position="after">
                        <field name="meeting_id" readonly="1"
                               attrs="{'invisible': [('meeting_id', '=', False)]}"/>
                    </field>
                    <button name="toggle_active" position="after">
                        <button name="sample_view" type="object" icon="fa-pencil-square-o" attrs="{'invisible': [('sample_number', '=', 0)]}"
                                context="{'default_partner_id': partner_id, 'search_default_draft': 1,
                                'default_sale_type': 'sample_gift', 'default_opportunity_id': active_id}">
                            <div class="o_stat_info">
                                <field name="sample_number" class="o_stat_value"/>
                                <span class="o_stat_text"> Samples/Gifts </span>
                        </div>
                        </button>
                        <button name="gift_view" type="object" icon="fa-pencil-square-o" attrs="{'invisible': [('gift_number', '=', 0)]}"
                                context="{'default_partner_id': partner_id, 'search_default_draft': 1}">
                            <div class="o_stat_info">
                                <field name="gift_number" class="o_stat_value"/>
                                <span class="o_stat_text"> Gifts </span>
                        </div>
                        </button>
                    </button>
                    <xpath expr="/form/sheet/group" position="before">
                        <group name="opportunity_type" string="Opportunity Type" colspan="8" col="8">
                            <field name="quotation" attrs="{'readonly': ['|',('sale_amount_total', '&gt;', 0), ('sale_number', '&gt;', 0)]}"/>
                            <field name="sample" attrs="{'readonly': [('sample_number', '&gt;', 0)]}"/>
                            <field name="gift_type" attrs="{'readonly': [('gift_number', '&gt;', 0)]}"/>
                        </group>
                    </xpath>
                    <xpath expr="/form/sheet/group" position="after">
                        <group name="details" string="Opportunity Details">
                        </group>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="sale_crm.sale_action_quotations" model="ir.actions.act_window">
            <field name="name">Quotations</field>
            <field name="res_model">sale.order</field>
            <field name="domain">[('opportunity_id', '=', active_id),('sale_type', '=', 'sale')]</field>
            <field name="context">{'search_default_opportunity_id': [active_id], 'default_opportunity_id': active_id}</field>
        </record>

        <menuitem
            id="crm.menu_crm_opportunities"
            action="crm.crm_lead_opportunities"
            name="Pipeline"
            parent="crm.crm_menu_pipeline"
            sequence="5"/>

    <!--============================inherit crm kanban view=======================-->

    <record id="crm.crm_case_kanban_view_leads" model="ir.ui.view">
            <field name="name">crm.lead.kanban.lead</field>
            <field name="model">crm.lead</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <kanban default_group_by="stage_id" class="o_kanban_small_column o_opportunity_kanban">
                    <field name="stage_id" options='{"group_by_tooltip": {"requirements": "Description", "legend_priority": "Use of stars"}}'/>
                    <field name="color"/>
                    <field name="priority"/>
                    <field name="planned_revenue"/>
                    <field name="kanban_state"/>
                    <field name="activity_date_deadline"/>
                    <field name="user_email"/>
                    <field name="user_id"/>
                    <field name="partner_address_email"/>
                    <field name="message_needaction_counter"/>
                    <field name="partner_id"/>
                    <field name="activity_summary"/>
                    <field name="active"/>
                    <field name="company_currency"/>
                    <field name="activity_state" />
                    <field name="activity_ids" />
                    <progressbar field="activity_state" colors='{"planned": "success", "today": "warning", "overdue": "danger"}' sum_field="planned_revenue"/>
                    <templates>
                        <field name="date_deadline"/>
                        <t t-name="kanban-box">
                            <div t-attf-class="#{kanban_color(record.color.raw_value)} oe_kanban_global_click">
                                <div class="o_dropdown_kanban dropdown">

                                    <a class="dropdown-toggle btn" data-toggle="dropdown" href="#" >
                                        <span class="fa fa-ellipsis-v"/>
                                    </a>
                                    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                        <t t-if="widget.editable"><li><a type="edit">Edit</a></li></t>
                                        <t t-if="widget.deletable"><li><a type="delete">Delete</a></li></t>
                                        <li t-if="! record.active.value"><a name="action_set_active" type="object">Restore</a></li>
                                        <li t-if="record.active.value"><a name="action_set_unactive" type="object">Archive</a></li>
                                        <li><ul class="oe_kanban_colorpicker" data-field="color"/></li>
                                    </ul>
                                </div>
                                <div class="oe_kanban_content">
                                    <div>
                                        <strong class="o_kanban_record_title"><field name="name"/></strong>
                                    </div>
                                    <div>
                                        <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
                                    </div>
                                    <div class="text-muted o_kanban_record_subtitle">
                                        <t t-if="record.planned_revenue.raw_value"><field name="planned_revenue" widget="monetary" options="{'currency_field': 'company_currency'}"/><span t-if="record.partner_id.value">,</span></t> <span t-if="record.partner_id.value"> <t t-esc="record.partner_id.value"/></span>
                                    </div>

                                    <div class="o_kanban_record_bottom">
                                        <div class="oe_kanban_bottom_left">
                                            <field name="priority" widget="priority" groups="base.group_user"/>
                                            <t t-if="record.message_needaction_counter.raw_value">
                                                <span class='oe_kanban_mail_new' title='Unread Messages'><i class='fa fa-comments'/><t t-raw="record.message_needaction_counter.raw_value"/></span>
                                            </t>
                                            <field name="activity_ids" widget="kanban_activity"/>
                                        </div>
                                        <div class="oe_kanban_bottom_right">
                                            <img t-att-src="kanban_image('res.users', 'image_small', record.user_id.raw_value)" t-att-title="record.user_id.value" width="24" height="24" class="oe_kanban_avatar"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="oe_clear"></div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>


    </data>
</odoo>